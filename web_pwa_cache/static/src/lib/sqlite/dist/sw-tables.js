self.sqliteWorker=function(e){"use strict";const t=["name","type","notnull","dflt_value","pk"],{keys:n}=Object,o=(e,t,o)=>new Promise(((u,i)=>{const m=r(t),f=n(o);e.all(`PRAGMA table_info('${m}')`,((t,n)=>{const{length:h}=n,p=f.map(c,o),d=`tmp_${m}_backup`,E=`CREATE TABLE IF NOT EXISTS '${h?d:m}' (${s(p)})`;h?e.run(E,(t=>{t?i(t):e.all(`PRAGMA table_info('${d}')`,((t,o)=>{if(n.length!==o.length||n.some(a,o)){const t=n.filter(l,o).map((e=>`'${r(e.name)}'`)),c=t.map((e=>`'${m}'.${e}`));e.run(`INSERT INTO '${d}' (${s(t)})\n                      SELECT ${s(c)} FROM '${m}'`,(t=>{t?e.run(`DROP TABLE IF EXISTS '${d}'`,(()=>i(t))):e.run(`DROP TABLE IF EXISTS '${m}'`,(()=>{e.run(`ALTER TABLE '${d}' RENAME TO '${m}'`,u)}))}))}else e.run(`DROP TABLE IF EXISTS '${d}'`,u)}))})):e.run(E,(e=>{e?i(e):u()}))}))})),r=e=>e.replace(/'/g,"''"),s=e=>e.join(", ");function l(e){return-1<this.findIndex((({name:t})=>t===e.name))}function c(e){return`'${r(e)}' ${this[e]}`}function a(e,n){const o=this[n];return t.some((t=>e[t]!==o[t]))}const u=(e,t)=>e(t).then((e=>t.tables?((e,t)=>new Promise(((r,s)=>{const l=[];for(const r of n(t))l.push(o(e,r,t[r]));Promise.all(l).then(r,s)})))((({all:e,query:t})=>({all(t,n){e([t]).then((e=>n(null,e)),n)},run(e,n){t([e]).then((()=>n()),n)}}))(e),t.tables).then((()=>e)):e));const i=new WeakMap,m=(e,...t)=>{const{t:n,v:o}=((e,t)=>{const n=[e[0]],o=[];for(let r=0,s=0,l=0,{length:c}=t;s<c;s++)t[s]instanceof f?n[r]+=t[s].v+e[s+1]:(o[l++]=s,n[++r]=e[s+1]);return{t:n,v:o}})(e,t),r=i.get(e)||i.set(e,{}).get(e);return(r[n]||(r[n]=[n])).concat(o.map((e=>t[e])))};function f(e){this.v=e}const h=(e,t)=>(n,...o)=>new Promise(((r,s)=>{n.some(E)&&s(p(new Error("SQLITE_ERROR: SQL injection hazard")));const[l,...c]=m(n,...o);e[t](l.join("?"),c,((e,t)=>{e?s(e):r(t)}))})),p=e=>(e.code="SQLITE_ERROR",e),d=(e,...t)=>new f(function(e){for(var t=e[0],n=1,o=arguments.length;n<o;n++)t+=arguments[n]+e[n];return t}(e,...t)),E=e=>e.includes("?");function T(e){return{all:h(e,"all"),get:h(e,"get"),query:h(e,"run"),raw:d}}const{assign:g}=Object,S="function"==typeof importScripts,$=t=>new Promise(((n,o)=>{const r=()=>{const e=self.module.exports;delete self.exports,self.module=void 0,n(e)};if(self.exports={},self.module={exports:e},S)importScripts(t),r();else{const{head:e}=document;g(e.appendChild(document.createElement("script")),{onload(){e.removeChild(this),r()},onerror:o,src:t})}})),w="sqlite",I="buffer",R=(e,t=1)=>new Promise(((n,o)=>{g(indexedDB.open(e,t),{onupgradeneeded({target:{result:e,transaction:t}}){e.objectStoreNames.contains(w)||e.createObjectStore(w).createIndex(I,I,{unique:!0}),g(t,{oncomplete(){n(e)}})},onsuccess({target:{result:e}}){n(e)},onerror:o})})),b=(e={})=>new Promise(((t,n)=>{const o=e.dist||".";$(o+"/sql-wasm.js").then((({default:r})=>{Promise.all([R(e.name||"sqlite-worker"),r({locateFile:e=>o+"/"+e})]).then((([o,{Database:r}])=>{const s=e=>o.transaction([w],e).objectStore(w);g(s("readonly").get(I),{onsuccess(){let n=Promise.resolve();const{result:o}=this,l=new r(o||e.database||new Uint8Array(0)),c=()=>{n=n.then((()=>new Promise(((t,n)=>{const o=l.export();g(s("readwrite").put(o,I).transaction,{oncomplete(){t(),e.update&&e.update(o)},onabort:n,onerror:n})}))))};o||c();const{all:a,get:u,query:i,raw:m}=T({all(e,t,n){try{const o=l.exec(e,t),r=[];o.forEach(P,r),n(null,r)}catch(e){n(e)}},get(e,t,n){try{const o=l.exec(e+" LIMIT 1",t),r=[];o.forEach(P,r),n(null,r.shift()||null)}catch(e){n(e)}},run(e,t,n){try{n(null,l.run(e,t))}catch(e){n(e)}}});let f=0;t({all:a,get:u,raw:m,query(t){return/\b(?:INSERT|DELETE|UPDATE)\b/i.test(t[0])&&(clearTimeout(f),f=setTimeout(c,e.timeout||250)),i.apply(this,arguments)}})},onerror:n})}),n)}))}));function P({columns:e,values:t}){for(let{length:n}=t,o=0;o<n;o++){const n=t[o],r={};for(let{length:t}=e,o=0;o<t;o++)r[e[o]]=n[o];this.push(r)}}return(e={})=>u(b,e)}({});